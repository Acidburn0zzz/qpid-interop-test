QUICKSTART GUIDE
================

0. Prerequisites
----------------
* qpid-proton built and installed
* For JMS testing, qpid-jms built and installed

1. Get the source
-----------------
git clone https://git-wip-us.apache.org/repos/asf/qpid-interop-test.git

2. Get and build Qpid Proton
----------------------------
git clone https://git-wip-us.apache.org/repos/asf/qpid-proton.git
cd qpid-proton
mkdir build
cd build
cmake ..
make
# installing is optional, if you want to install, then the following line:
sudo make install
cd ..
mvn -DskipTests install

3. Get and build Qpid JMS
-------------------------
git clone https://git-wip-us.apache.org/repos/asf/qpid-jms.git
cd qpid-jms
mvn -DskipTests install


3 Prepare the tests
-------------------
(ONLY IF NEEDED): Edit src/python/qpid_interop/types/simple_type_tests.py as
needed, particularly AmqpPrimitiveTypes.TYPE_MAP which controls the AMQP types
and test values for each type.

4. Build qpid-interop-test components:
--------------------------------------
cd qpid-interop-test
./java-clean.sh
./java-buuld.sh
cd shims/qpid-jms
./java-clean.sh
./java-buuld.sh
cd ../qpid-proton-cpp
mkdir build
cd build
ccmake ..
make clean
make
cd ../../..

5. Run the tests (uninstalled)
------------------------------
Note that installation is still to be completed, this section will change to
reflect installation details when complete.

Select one of the following two options:

a. qpid-proton installed (default install location):
Assuming proton's "make install" has been run, from top level qpid-interop-test directory:
export PYTHONPATH=/usr/local/lib64/proton/bindings/python:src/py/qpid-interop-test
export LD_LIBRARY_PATH=/usr/local/lib64
export QPID_INTEROP_TEST_HOME=<abs path to top level qpid-interop-test directory>

b. qpid-proton installed to local directory <abs-path-to-local-proton-install-dir>:
Assuming proton's "make install" has been run, from top level qpid-interop-test directory:
export PYTHONPATH=<abs-path-to-local-proton-install-dir>/lib64/proton/bindings/python:src/python/qpid-interop-test
export LD_LIBRARY_PATH=<abs-path-to-local-proton-install-dir>/lib64
export QPID_INTEROP_TEST_HOME=<abs path to top level qpid-interop-test directory>

c. qpid-proton built but not installed:
Assuming proton's "make" has been run from a "build" directory as described in the proton README (but not make install), from top level qpid-interop-test directory:
export PYTHONPATH=<abs path to top level qpid-proton directory>/proton-c/bindings/python:<abs path to top level qpid-proton directory>/build/proton-c/bindings/python:src/python/qpid-interop-test
export LD_LIBRARY_PATH=<abs path to top level qpid-proton directory>/build/proton-c
export QPID_INTEROP_TEST_HOME=<abs path to top level qpid-interop-test directory>

Start a broker (Artemis, Active-MQ or Qpid).
NOTE: For qpidd, YOU MUST USE THE FOLLOWING PARAMETERS:
  --load-module amqp : will enable the AMQP 1.0 protocol
  --queue-pattern jms.queue.qpid-interop: will automatically create queues using this prefix as needed
  --auth no : will disable authentication (which these tests do not use).

From top level directory:
AMQP type tests:
./src/python/qpid-interop-test/types/simple_type_tests.py

JMS message tests:
./src/python/qpid-interop-test/jms/jms_message_tests.py

